{"version":3,"file":"index.js","sources":["../src/js/api.js","../src/js/render.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function fetchImg(query, currentPage) {\n  const BASE_URL = 'https://pixabay.com';\n  const END_POINT = '/api/';\n  const API_KEY = '42059071-0978dc0d7158b742eee7c30f5';\n\n  const params = {\n    q: encodeURIComponent(query),\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: 15,\n  };\n\n  const url = `${BASE_URL}${END_POINT}?key=${API_KEY}`;\n\n  const resp = await axios.get(url, { params });\n  return resp.data;\n}\n","function templateHit(hit) {\n  const {\n    webformatURL,\n    largeImageURL,\n    comments,\n    downloads,\n    tags,\n    likes,\n    views,\n  } = hit;\n  return ` <a href=\"${largeImageURL}\" class=\"card\" >\n      <li>\n        <img src=\"${webformatURL}\" alt=\"${tags}\" />\n        <div class='card-bottom'>\n        <p><b>Views: </b>${views}</p>\n        <p><b>Likes: </b>${likes}</p>\n        <p><b>Downloads: </b>${downloads}</p>\n        <p><b>Comments: </b>${comments}</p>\n        </div>\n      </li>\n    </a>`;\n}\n\nexport function templateHits(hits) {\n  return hits.map(templateHit).join('');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchImg } from './js/api';\nimport { templateHits } from './js/render';\n\nconst refs = {\n  form: document.querySelector('.js-form'),\n  more: document.querySelector('.js-more'),\n  gallery: document.querySelector('.js-gallery'),\n  target: document.querySelector('.js-target'),\n};\nlet page;\nlet query;\nlet lastPage;\n\nrefs.form.addEventListener('submit', onSubmit);\n// refs.more.addEventListener('click', onMore);\n\nasync function onSubmit(ev) {\n  ev.preventDefault();\n  page = 1;\n\n  query = ev.target.elements.query.value.trim();\n  if (!query) {\n    iziToast.warning({\n      title: 'Error!',\n      message: 'No query!',\n      position: 'center',\n    });\n    return;\n  }\n  const data = await fetchImg(query, page);\n  lastPage = Math.ceil(data.total / 15);\n  if (data.total === 0) {\n    iziToast.error({\n      title: 'Sorry!',\n      message: 'No images found for your query',\n      position: 'center',\n    });\n  }\n  refs.gallery.innerHTML = '';\n  renderImages(data.hits);\n\n  checkStatus();\n\n  refs.form.reset();\n}\n\nasync function onMore() {\n  page += 1;\n\n  const data = await fetchImg(query, page);\n\n  renderImages(data.hits);\n  checkStatus();\n\n  const height = refs.gallery.firstElementChild.getBoundingClientRect().height;\n\n  scrollBy({\n    behavior: 'smooth',\n    top: height * 2,\n  });\n\n  refs.form.reset();\n}\n\nfunction renderImages(hits) {\n  const markup = templateHits(hits);\n  refs.gallery.insertAdjacentHTML('beforeend', markup);\n}\n\n// function showMore() {\n//   refs.more.classList.remove('hidden');\n// }\n\n// function hideMore() {\n//   refs.more.classList.add('hidden');\n// }\n\n// function checkMore() {\n//   if (page >= lastPage) {\n//     hideMore();\n//   } else {\n//     showMore();\n//   }\n// }\n\nconst options = {\n  root: document.querySelector('#scrollArea'),\n  rootMargin: '0px',\n  threshold: 1.0,\n};\n\nconst callback = (entries, observer) => {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      onMore();\n    }\n  });\n};\n\nconst observer = new IntersectionObserver(callback, options);\n\nfunction observeTarget() {\n  observer.observe(refs.target);\n}\n\nfunction unobserveTarget() {\n  observer.unobserve(refs.target);\n}\nfunction checkStatus() {\n  if (page >= lastPage) {\n    unobserveTarget();\n  } else {\n    observeTarget();\n  }\n}\n"],"names":["fetchImg","query","currentPage","BASE_URL","END_POINT","API_KEY","params","url","axios","templateHit","hit","webformatURL","largeImageURL","comments","downloads","tags","likes","views","templateHits","hits","refs","page","lastPage","onSubmit","ev","iziToast","data","renderImages","checkStatus","onMore","height","markup","options","callback","entries","observer","entry","observeTarget","unobserveTarget"],"mappings":"6vBAEO,eAAeA,EAASC,EAAOC,EAAa,CACjD,MAAMC,EAAW,sBACXC,EAAY,QACZC,EAAU,qCAEVC,EAAS,CACb,EAAG,mBAAmBL,CAAK,EAC3B,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAU,EACd,EAEQK,EAAM,GAAGJ,CAAQ,GAAGC,CAAS,QAAQC,CAAO,GAGlD,OADa,MAAMG,EAAM,IAAID,EAAK,CAAE,OAAAD,CAAM,CAAE,GAChC,IACd,CCpBA,SAASG,EAAYC,EAAK,CACxB,KAAM,CACJ,aAAAC,EACA,cAAAC,EACA,SAAAC,EACA,UAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,CACD,EAAGP,EACJ,MAAO,aAAaE,CAAa;AAAA;AAAA,oBAEfD,CAAY,UAAUI,CAAI;AAAA;AAAA,2BAEnBE,CAAK;AAAA,2BACLD,CAAK;AAAA,+BACDF,CAAS;AAAA,8BACVD,CAAQ;AAAA;AAAA;AAAA,SAItC,CAEO,SAASK,EAAaC,EAAM,CACjC,OAAOA,EAAK,IAAIV,CAAW,EAAE,KAAK,EAAE,CACtC,CCpBA,MAAMW,EAAO,CACX,KAAM,SAAS,cAAc,UAAU,EACvC,KAAM,SAAS,cAAc,UAAU,EACvC,QAAS,SAAS,cAAc,aAAa,EAC7C,OAAQ,SAAS,cAAc,YAAY,CAC7C,EACA,IAAIC,EACApB,EACAqB,EAEJF,EAAK,KAAK,iBAAiB,SAAUG,CAAQ,EAG7C,eAAeA,EAASC,EAAI,CAK1B,GAJAA,EAAG,eAAc,EACjBH,EAAO,EAEPpB,EAAQuB,EAAG,OAAO,SAAS,MAAM,MAAM,OACnC,CAACvB,EAAO,CACVwB,EAAS,QAAQ,CACf,MAAO,SACP,QAAS,YACT,SAAU,QAChB,CAAK,EACD,MACD,CACD,MAAMC,EAAO,MAAM1B,EAASC,EAAOoB,CAAI,EACvCC,EAAW,KAAK,KAAKI,EAAK,MAAQ,EAAE,EAChCA,EAAK,QAAU,GACjBD,EAAS,MAAM,CACb,MAAO,SACP,QAAS,iCACT,SAAU,QAChB,CAAK,EAEHL,EAAK,QAAQ,UAAY,GACzBO,EAAaD,EAAK,IAAI,EAEtBE,IAEAR,EAAK,KAAK,OACZ,CAEA,eAAeS,GAAS,CACtBR,GAAQ,EAER,MAAMK,EAAO,MAAM1B,EAASC,EAAOoB,CAAI,EAEvCM,EAAaD,EAAK,IAAI,EACtBE,IAEA,MAAME,EAASV,EAAK,QAAQ,kBAAkB,sBAAuB,EAAC,OAEtE,SAAS,CACP,SAAU,SACV,IAAKU,EAAS,CAClB,CAAG,EAEDV,EAAK,KAAK,OACZ,CAEA,SAASO,EAAaR,EAAM,CAC1B,MAAMY,EAASb,EAAaC,CAAI,EAChCC,EAAK,QAAQ,mBAAmB,YAAaW,CAAM,CACrD,CAkBA,MAAMC,EAAU,CACd,KAAM,SAAS,cAAc,aAAa,EAC1C,WAAY,MACZ,UAAW,CACb,EAEMC,EAAW,CAACC,EAASC,IAAa,CACtCD,EAAQ,QAAQE,GAAS,CACnBA,EAAM,gBACRP,GAEN,CAAG,CACH,EAEMM,EAAW,IAAI,qBAAqBF,EAAUD,CAAO,EAE3D,SAASK,GAAgB,CACvBF,EAAS,QAAQf,EAAK,MAAM,CAC9B,CAEA,SAASkB,GAAkB,CACzBH,EAAS,UAAUf,EAAK,MAAM,CAChC,CACA,SAASQ,GAAc,CACjBP,GAAQC,EACVgB,IAEAD,GAEJ"}